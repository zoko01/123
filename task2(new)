import pandas as pd

kdrama_info = {'Dokkaebi': {'name': 'Демон', 'genre': 'фэнтези, мелодрама, драма, комедия', 'age restrictions': 16, 'year': 2016, 'actors': ['Кон Ю', 'Ким Го-ын', 'Ли Дон-ук', 'Ю Ин-на', 'Юк Сон-джэ', 'Ли Эль', 'Чо У-джин', 'Ким Сон-гём', 'Пак Хи-бон', 'Хан Со-джин'], 'rating': 8.6, 'review': 'Бессмертный демон токкэби много лет живет среди смертных и порядком устал от жизни. Но если ты волшебное существо, есть лишь один способ поставить точку и покинуть бренный мир — жениться на смертной. Избранницей демона становится девушка, которая может видеть призраков. А ангел смерти, чья задача провожать души умерших в загробный мир, тем временем потерял память.'},
        'Gumihodyeon': {'name': 'История девятихвостого лиса', 'genre': 'мелодрама, фэнтези', 'age restrictions': 16, 'year': 2020, 'actors': ['Ли Дон-ук', 'Чо Бо-а', 'Ким Бом', 'Ким Ён-джи', 'Ким Хи-джон', 'Чон Щи-юль', 'Хван Хи', 'Ким Джон-нан', 'Ан Гиль-ган', 'Чан Вон-хён'], 'rating': 8.3, 'review': 'Ли Ён — божество, живущее в горах, которое принимает человеческий облик, чтобы навести порядок в мире людей. А вот его сводный брат Ли Ран — кумихо, который людей ненавидит. Именно на них выходит продюсер экстремального шоу Нам Джи-а. Она давно охотится за девятихвостым лисом, чтобы заснять его для одного из выпусков.'},
        'Himssen yeoja Do Bongsun': {'name': 'Силачка То Бон-сун', 'genre': 'комедия, мелодрама, фантастика, детектив', 'age restrictions': 16, 'year': 2017, 'actors': ['Пак По-ён', 'Пак Хён-щик', 'Чи Су', 'Ан У-ён', 'Соль Ин-а', 'Щим Хе-джин', 'Ю Джэ-мён', 'Чон Сок-хо', 'Лим Вон-хи', 'Ким Мин-гё'], 'rating': 8.1, 'review': 'Невероятно сильная девушка То Бон-сун влюблена в Кук-ту, педанта и зануду, поэтому она изо всех сил пытается подстроиться под его идеальный типаж — быть милой, очаровательной и изящной. То есть обычной. Но Бон-сун всё-таки необычная, поэтому получает работу телохранителя наследника богатой семьи Ан Мин-хёка. А тот — полная противоположность её возлюбленного: импульсивный, высокомерный и избалованный.'},
        'Eoneu nal uri jip hyeokgwaneuro myeolmangi deuleowatta': {'name': 'Однажды разрушение постучалось в мою дверь', 'genre': 'мелодрама, фэнтези', 'age restrictions': 16, 'year': 2021, 'actors': ['Пак По-ён', 'Со Ин-гук', 'Ли Су-хёк', 'Кан Тхэ-о', 'Щин До-хён', 'Ли Да-вон', 'У Хи-джин', 'Чон Джи-со', 'Ли Сын-джун', 'Сон Джу-хи'], 'rating': 8.2, 'review': 'В обычной жизни редактора интернет-романов однажды появляется загадочный незнакомец и предлагает рискованную сделку.'},
    'Haepiniseu': {'name': 'Счастье', 'genre': 'фантастика, драма, ужасы, мелодрама', 'age restrictions': 16, 'year': 2021, 'actors': ['Хан Хё-джу', 'Пак Хён-щик', 'Чо У-джин', 'Ли Джун-хёк', 'Пэк Хён-джин', 'Пэ Хэ-сон', 'Мун Е-вон', 'Пак Хён-су', 'Чон Ун-сон', 'Сон Джи-у'], 'rating': 8.3, 'review': 'Люди разных социальных статусов из-за вируса застревают в элитной высотке. Фантастический триллер из Кореи'}}

def get_info(kdrama_info, *actors, info="name, rating"):

    dictactors = dict()

    for k, i in kdrama_info.items():

        matchedactors = [actor for actor in actors if actor in i['actors']]

        if len(matchedactors) > 0:
            dictactors[k] = i
            dictactors[k]['actor'] = ', '.join(matchedactors)
            dictactors[k]['korean name'] = k

    if len(dictactors) == 0:
        return 'Таких сериалов нет'
    
    else:
        column = [c.strip() for c in info.split(',')]
        column = [c for c in column if c != 'actor' and c != 'name']
        column = ['actor', 'name'] + column
        
        lastdict = {k: {col: i[col] for col in column} for k, i in dictactors.items()}
        
        return pd.DataFrame.from_dict(lastdict, orient='index').sort_values(by='name').reset_index(drop=True)
