import pandas as pd

kdrama_info = {'Ojingeo geim': {'name': 'Игра в кальмара',
                                'genre': 'триллер, драма',
                                'age restrictions': 18, 
                                'year': 2021, 
                                'actors': ['Ли Джон-джэ', 'Пак Хэ-су', 'О Ён-су', 'Чон Хо-ён', 'Хо Сон-тхэ', 'Анупам Трипати', 'Ким Джу-рён', 'Ви Ха-джун', 'Ю Сон-джу', 'Ли Ю-ми'], 
                                'rating': 7.5, 
                                'review': 'Сон Ги-хун уже немолод, разведён, по уши погряз в долгах и сидит на шее у старенькой матери. Даже выигранные на скачках деньги в его руках долго не задерживаются, и однажды он встречает в метро загадочного незнакомца, который сначала предлагает сыграть в детскую игру, а затем вручает Ги-хуну немалую сумму и визитку. Но радость мужчины сменятся отчаянием, когда он узнаёт, что бывшая жена с новым мужем собираются увезти его дочь в Америку. Он звонит по номеру с визитки и становится последним участником тайных игр на выживание с призом в 40 миллионов долларов. Среди товарищей по несчастью оказываются его друг детства — прогоревший финансист, бандит, смертельно больной старик, северокорейская перебежчица, иммигрант из Пакистана и многие другие отчаянно нуждающиеся в деньгах.' },

        'Kimbiseoga wae geureolkka?': {'name': 'Что случилось с секретарём Ким?', 
                                       'genre': 'мелодрама', 
                                       'age restrictions': 12, 
                                       'year': 2018,
                                       'actors': ['Пак Со-джун', 'Пак Мин-ён', 'Хван Чхан-сон', 'Ли Тхэ-хван', 'Пхё Е-джин', 'Ким Хе-ок','Ким Бён-ок', 'Кан Ги-ён', 'Кан Хон-сок', 'Хван Бо-ра'], 
                                       'rating': 8.1, 
                                       'review': 'Богатый наследник Ли Ён-джун занимает должность вице-президента семейной компании. Он красив, умён и высокомерен. Его секретарь Ким Ми-со работала с ним несколько лет и идеально справлялась с работой, но теперь девушка решила уволиться.'},

        'Haepiniseu': {'name': 'Счастье', 
                       'genre': 'фантастика, драма, ужасы, мелодрама', 
                       'age restrictions': 16, 
                       'year': 2021, 
                       'actors': ['Хан Хё-джу', 'Пак Хён-щик', 'Чо У-джин', 'Ли Джун-хёк', 'Пэк Хён-джин', 'Пэ Хэ-сон', 'Мун Е-вон', 'Пак Хён-су', 'Чон Ун-сон', 'Сон Джи-у'], 
                       'rating': 8.3, 
                       'review': 'Люди разных социальных статусов из-за вируса застревают в элитной высотке. Фантастический триллер из Кореи'},

        'Saikojiman gwaenchanha': {'name': 'Я псих, но это нормально', 
                                   'genre': 'драма, мелодрама, фэнтези', 
                                   'age restrictions': 12, 
                                   'year': 2020, 
                                   'actors': ['Ким Су-хён', 'Со Е-джи', 'Пак Кю-ён', 'О Джон-сэ', 'Ким Джу-хон', 'Пак Чин-джу', 'Ким Чхан-ван', 'Чан Ён-нам', 'Кан Ги-дун', 'Ким Ми-гён'], 
                                   'rating': 8.2, 
                                   'review': 'История о сотруднике больницы для душевнобольных, который вынужден ухаживать за особенным братом, и популярной детской писательнице с диссоциальным расстройством личности.'}}

def get_info(kdrama_info, age, info):

    age=[age]

    info = ['age restrictions', 'name', info]

    # Группировка актёров
    for i in kdrama_info.copy():
        a=kdrama_info[i]
        for j in a:
            if j=="actors":
                p=a[j]
                a[j]=", ".join(p)

    # Добавление korean name
    for i in kdrama_info.copy():
        a=kdrama_info[i]
        a['korean name']=i

    # Сортируем по Возрасту главный словарь
    for i in kdrama_info.copy():
        a=kdrama_info[i]
        ageres=a['age restrictions']
        if not(ageres in age):
            kdrama_info.pop(i)

    # Удаление не нужной информации
    for i in kdrama_info.copy():
        a=kdrama_info[i]
        for j in a.copy():
            if not(j in info):
                del a[j]
    res = 0
    for i in kdrama_info:
        res=pd.DataFrame(data=kdrama_info[i], columns=info, index=[0])
        print(res)
    try:
        if res == 0:
            print("Для вас нет подходящего сериала")
    except ValueError:
        pass


get_info(kdrama_info, 12, 'korean name')
